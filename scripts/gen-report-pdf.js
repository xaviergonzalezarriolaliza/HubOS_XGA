const fs = require('fs');
const path = require('path');
const { chromium } = require('playwright');

async function main() {
  const out = path.resolve(__dirname, '..', 'docs', 'HubOS_QA_Engineer_Homework_XGA.pdf');
  const reportPath = 'test-results/report_2025-12-23_19-21-02';
  const html = `
  <html>
    <head>
      <meta charset="utf-8" />
      <title>HubOS QA — Latest Test Run</title>
      <style>
        body { font-family: Arial, Helvetica, sans-serif; margin: 40px; }
        h1 { color: #0b5cff }
        .meta { margin-top: 20px; }
        .link { margin-top: 20px; }
        a { color: #0b5cff }
      </style>
    </head>
    <body>
      <h1>HubOS QA Engineer — Latest Test Run</h1>
      <p class="meta"><strong>Date:</strong> 2025-12-23</p>
      <p class="meta"><strong>Summary:</strong> 352 passed (11.9m)</p>
      <div class="link">
        <p>Playwright report (local workspace):</p>
        <p><a href="${reportPath}">${reportPath}</a></p>
        <p>Note: To view the full HTML report open the <code>index.html</code> inside that folder.</p>
      </div>
      <hr />
      <p>Generated by automated test tooling.</p>
    </body>
  </html>`;

  const browser = await chromium.launch();
  const page = await browser.newPage();
  await page.setContent(html, { waitUntil: 'networkidle' });
  await page.pdf({ path: out, format: 'A4' });
  await browser.close();
  console.log('PDF written to', out);
}

main().catch(err => {
  console.error(err);
  process.exit(1);
});
